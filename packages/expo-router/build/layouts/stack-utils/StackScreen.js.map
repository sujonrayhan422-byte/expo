{"version":3,"file":"StackScreen.js","sourceRoot":"","sources":["../../../src/layouts/stack-utils/StackScreen.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client';\nimport { NativeStackNavigationOptions } from '@react-navigation/native-stack';\nimport { Children, isValidElement, useMemo, type PropsWithChildren, type ReactNode } from 'react';\n\nimport {\n  StackHeaderComponent,\n  appendStackHeaderPropsToOptions,\n  type StackHeaderProps,\n} from './StackHeaderComponent';\nimport {\n  StackScreenTitle,\n  appendStackScreenTitlePropsToOptions,\n  type StackScreenTitleProps,\n  StackScreenBackButton,\n  appendStackScreenBackButtonPropsToOptions,\n  type StackScreenBackButtonProps,\n} from './screen';\nimport {\n  StackToolbarLeft,\n  appendStackToolbarLeftPropsToOptions,\n  type StackToolbarLeftProps,\n  StackToolbarRight,\n  appendStackToolbarRightPropsToOptions,\n  type StackToolbarRightProps,\n  StackToolbarBottom,\n} from './toolbar';\nimport { Screen } from '../../views/Screen';\n\nexport interface StackScreenProps extends PropsWithChildren {\n  name?: string;\n  options?: NativeStackNavigationOptions;\n}\n\nfunction extractBottomToolbars(\n  children: ReactNode\n): React.ReactElement<typeof StackToolbarBottom>[] {\n  return (\n    Children.map(children, (child) => {\n      if (isValidElement(child) && child.type === StackToolbarBottom) {\n        return child as React.ReactElement<typeof StackToolbarBottom>;\n      }\n      return null;\n    })?.filter((child) => child !== null) ?? []\n  );\n}\n\nexport function StackScreen({ children, options, ...rest }: StackScreenProps) {\n  // This component will only render when used inside a page.\n  const updatedOptions = useMemo(\n    () =>\n      appendScreenStackPropsToOptions(options ?? {}, {\n        children,\n      }),\n    [options, children]\n  );\n\n  const bottomToolbars = useMemo(() => extractBottomToolbars(children), [children]);\n\n  return (\n    <>\n      <Screen {...rest} options={updatedOptions} />\n      {/* Bottom toolbar is a native component rendered separately */}\n      {bottomToolbars}\n    </>\n  );\n}\n\nStackScreen.Title = StackScreenTitle;\nStackScreen.BackButton = StackScreenBackButton;\n\nexport function appendScreenStackPropsToOptions(\n  options: NativeStackNavigationOptions,\n  props: StackScreenProps\n): NativeStackNavigationOptions {\n  let updatedOptions = { ...options, ...props.options };\n\n  function appendChildOptions(child: React.ReactElement, opts: NativeStackNavigationOptions) {\n    if (child.type === StackHeaderComponent) {\n      return appendStackHeaderPropsToOptions(opts, child.props as StackHeaderProps);\n    }\n\n    if (child.type === StackScreenTitle) {\n      return appendStackScreenTitlePropsToOptions(opts, child.props as StackScreenTitleProps);\n    }\n\n    if (child.type === StackScreenBackButton) {\n      return appendStackScreenBackButtonPropsToOptions(\n        opts,\n        child.props as StackScreenBackButtonProps\n      );\n    }\n\n    if (child.type === StackToolbarLeft) {\n      return appendStackToolbarLeftPropsToOptions(opts, child.props as StackToolbarLeftProps);\n    }\n\n    if (child.type === StackToolbarRight) {\n      return appendStackToolbarRightPropsToOptions(opts, child.props as StackToolbarRightProps);\n    }\n\n    if (child.type === StackToolbarBottom) {\n      throw new Error(\n        `Stack.Toolbar.Bottom cannot be used inside Stack.Screen in _layout.tsx. Please move it to the page component.`\n      );\n    }\n\n    const typeName =\n      typeof child.type === 'function'\n        ? (child.type as { name?: string }).name || 'Unknown'\n        : String(child.type);\n    console.warn(`Unknown child element passed to Stack.Screen: ${typeName}`);\n    return opts;\n  }\n\n  Children.forEach(props.children, (child) => {\n    if (isValidElement(child)) {\n      updatedOptions = appendChildOptions(child, updatedOptions);\n    }\n  });\n\n  return updatedOptions;\n}\n"]}